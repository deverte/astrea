/**
 * \file astrea/spectrum/gj_3470_bourrier.h
 * GJ 3470 XUV spectrum by Bourrier+2018 (<1200 A), Salz+2016 (>1200 A).
 * Total energy below 912 A is 4.91 erg/cm^2 at R=1 a.u.
 * 
 * \copyright GPL
 * \author Artem Shepelin (4.shepelin@gmail.com)
 */
#pragma once


#include <Eigen/Dense>


namespace astrea::spectrum::gj_3470_bourrier {


/**
 * GJ 3470 XUV spectrum by Bourrier+2018 (<1200 A), Salz+2016 (>1200 A).
 * 
 * - Axis 0: Bivariate data (row).
 *   - 0: Wavelength in A.
 *   - 1: Spectral irradiance in s-1 cm-2 A-1.
 * - Axis 1: Bivariate pair index (column).
 */
inline Eigen::Matrix<double, 2, 281> E_q_lambda_vs_lambda() {
  Eigen::Matrix<double, 2, 281> E_q_lambda_vs_lambda {
    {10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380, 390, 400, 410, 420, 430, 440, 450, 460, 470, 480, 490, 500, 510, 520, 530, 540, 550, 560, 570, 580, 590, 600, 610, 620, 630, 640, 650, 660, 670, 680, 690, 700, 710, 720, 730, 740, 750, 760, 770, 780, 790, 800, 810, 820, 830, 840, 850, 860, 870, 880, 890, 900, 910, 915, 920, 930, 940, 950, 960, 970, 980, 990, 1000, 1010.0, 1020.0, 1030.0, 1040.0, 1050.0, 1060.0, 1070.0, 1080.0, 1090.0, 1100.0, 1110.0, 1120.0, 1130.0, 1140.0, 1150.0, 1160.0, 1170.0, 1180.0, 1190.0, 1200.0, 1210.0, 1220.0, 1230.0, 1240.0, 1250.0, 1260.0, 1270.0, 1280.0, 1290.0, 1300.0, 1310.0, 1320.0, 1330.0, 1340.0, 1350.0, 1360.0, 1370.0, 1380.0, 1390.0, 1400.0, 1410.0, 1420.0, 1430.0, 1440.0, 1450.0, 1460.0, 1470.0, 1480.0, 1490.0, 1500.0, 1510.0, 1520.0, 1530.0, 1540.0, 1550.0, 1560.0, 1570.0, 1580.0, 1590.0, 1600.0, 1610.0, 1620.0, 1630.0, 1640.0, 1650.0, 1660.0, 1670.0, 1680.0, 1690.0, 1700.0, 1710.0, 1720.0, 1730.0, 1740.0, 1750.0, 1760.0, 1770.0, 1780.0, 1790.0, 1800.0, 1810.0, 1820.0, 1830.0, 1840.0, 1850.0, 1860.0, 1870.0, 1880.0, 1890.0, 1900.0, 1910.0, 1920.0, 1930.0, 1940.0, 1950.0, 1960.0, 1970.0, 1980.0, 1990.0, 2000.0, 2010.0, 2020.0, 2030.0, 2040.0, 2050.0, 2060.0, 2070.0, 2080.0, 2090.0, 2100.0, 2110.0, 2120.0, 2130.0, 2140.0, 2150.0, 2160.0, 2170.0, 2180.0, 2190.0, 2200.0, 2210.0, 2220.0, 2230.0, 2240.0, 2250.0, 2260.0, 2270.0, 2280.0, 2290.0, 2300.0, 2310.0, 2320.0, 2330.0, 2340.0, 2350.0, 2360.0, 2370.0, 2380.0, 2390.0, 2400.0, 2410.0, 2420.0, 2430.0, 2440.0, 2450.0, 2460.0, 2470.0, 2480.0, 2490.0, 2500.0, 2510.0, 2520.0, 2530.0, 2540.0, 2550.0, 2560.0, 2570.0, 2580.0, 2590.0, 2600.0, 2610.0, 2620.0, 2630.0, 2640.0, 2650.0, 2660.0, 2670.0, 2680.0, 2690.0, 2700.0, 2710.0, 2720.0, 2730.0, 2740.0, 2750.0, 2760.0, 2770.0, 2780.0, 2790.0, 2800.0},
    {4283940.0, 8567890.0, 12851800.0, 17135800.0, 21419700.0, 25703700.0, 29987600.0, 34271600.0, 38555500.0, 42839400.0, 7207110.0, 7862300.0, 8517490.0, 9172680.0, 9827870.0, 10483100.0, 11138300.0, 11793400.0, 12448600.0, 13103800.0, 24342900.0, 25502100.0, 26661300.0, 27820400.0, 28979600.0, 30138800.0, 31298000.0, 32457200.0, 33616400.0, 34775500.0, 70307100.0, 72575100.0, 74843000.0, 77111000.0, 79379000.0, 81646900.0, 83914900.0, 86182900.0, 88450900.0, 90718800.0, 41327500.0, 42335400.0, 43343400.0, 44351400.0, 45359400.0, 46367400.0, 47375400.0, 48383400.0, 49391400.0, 50399300.0, 51407300.0, 52415300.0, 53423300.0, 54431300.0, 55439300.0, 282236000.0, 287276000.0, 292316000.0, 297356000.0, 302396000.0, 307436000.0, 312476000.0, 317516000.0, 322556000.0, 327596000.0, 332636000.0, 337676000.0, 342716000.0, 347755000.0, 352795000.0, 250485000.0, 254013000.0, 257541000.0, 261069000.0, 264597000.0, 268125000.0, 271652000.0, 275180000.0, 278708000.0, 282236000.0, 285764000.0, 289292000.0, 292820000.0, 296348000.0, 299876000.0, 303404000.0, 306932000.0, 310460000.0, 313988000.0, 317516000.0, 321044000.0, 329044000.0, 338482000.0, 342161000.0, 345840000.0, 349519000.0, 353199000.0, 356878000.0, 360557000.0, 364236000.0, 367915000.0, 371594000.0, 375274000.0, 378953000.0, 382632000.0, 386311000.0, 106847000.0, 107855000.0, 108863000.0, 109871000.0, 110879000.0, 111887000.0, 112895000.0, 113903000.0, 114911000.0, 115918000.0, 116926000.0, 117934000.0, 118942000.0, 119950000.0, 120958000.0, 121966000.0, 7993340000.0, 123982000.0, 124990000.0, 125998000.0, 127006000.0, 128014000.0, 129022000.0, 130030000.0, 131038000.0, 132046000.0, 133054000.0, 134062000.0, 135070000.0, 136078000.0, 137086000.0, 138094000.0, 139102000.0, 140110000.0, 141118000.0, 142126000.0, 143134000.0, 144142000.0, 145150000.0, 146158000.0, 147166000.0, 148174000.0, 149182000.0, 150190000.0, 151198000.0, 152206000.0, 153214000.0, 154222000.0, 155230000.0, 156238000.0, 157246000.0, 158254000.0, 159262000.0, 160270000.0, 161278000.0, 162286000.0, 163294000.0, 164302000.0, 165310000.0, 166318000.0, 167326000.0, 168334000.0, 169342000.0, 170350000.0, 171358000.0, 172366000.0, 173374000.0, 174382000.0, 175390000.0, 176398000.0, 177406000.0, 178414000.0, 179422000.0, 180430000.0, 181438000.0, 182446000.0, 183454000.0, 184462000.0, 185470000.0, 186478000.0, 187486000.0, 188494000.0, 189502000.0, 190510000.0, 191518000.0, 192525000.0, 193533000.0, 194541000.0, 195549000.0, 196557000.0, 197565000.0, 198573000.0, 199581000.0, 200589000.0, 201597000.0, 202605000.0, 203613000.0, 204621000.0, 205629000.0, 206637000.0, 207645000.0, 208653000.0, 209661000.0, 210669000.0, 211677000.0, 212685000.0, 213693000.0, 214701000.0, 215709000.0, 216717000.0, 217725000.0, 218733000.0, 219741000.0, 220749000.0, 221757000.0, 222765000.0, 223773000.0, 224781000.0, 225789000.0, 226797000.0, 227805000.0, 228813000.0, 229821000.0, 230829000.0, 231837000.0, 232845000.0, 233853000.0, 234861000.0, 235869000.0, 236877000.0, 237885000.0, 238893000.0, 239901000.0, 240909000.0, 241917000.0, 242925000.0, 243933000.0, 244941000.0, 245949000.0, 246957000.0, 247965000.0, 248973000.0, 249981000.0, 250989000.0, 251997000.0, 253005000.0, 254013000.0, 255021000.0, 256029000.0, 257037000.0, 258045000.0, 259053000.0, 260061000.0, 261069000.0, 262077000.0, 263085000.0, 264093000.0, 265101000.0, 266109000.0, 267117000.0, 268125000.0, 269133000.0, 270140000.0, 271148000.0, 272156000.0, 273164000.0, 274172000.0, 275180000.0, 276188000.0, 277196000.0, 278204000.0, 279212000.0, 280220000.0, 281228000.0, 282236000.0},
  };
  return E_q_lambda_vs_lambda;
}


/**
 * GJ 3470 XUV spectrum by Bourrier+2018 (<1200 A), Salz+2016 (>1200 A).
 * 
 * - Axis 0: Bivariate data (row).
 *   - 0: Wavelength in nm.
 *   - 1: Spectral irradiance in W m-2 nm-1.
 * - Axis 1: Bivariate pair index (column).
 */
inline Eigen::Matrix<double, 2, 281> F_lambda_vs_lambda() {
  const double alpha = 1.9864458571489286e-11; // m-2 W A s cm2
  const double A_to_nm = 1.0e-1; // nm A-1

  const auto irradiance = E_q_lambda_vs_lambda();

  Eigen::Matrix<double, 2, 281> F_lambda_vs_lambda;
  F_lambda_vs_lambda.row(0) = irradiance.row(0) * A_to_nm;
  F_lambda_vs_lambda.row(1) =
    alpha / F_lambda_vs_lambda.row(0).array() * irradiance.row(1).array();

  return F_lambda_vs_lambda;
}


}