#pragma once


#include <algorithm>
#include <memory>
#include <vector>

#include <boost/math/interpolators/barycentric_rational.hpp>

#include "./spectrum.h"


namespace lss {


/**
 * Kelt 9 spectrum
 * 
 * data: private communication
 */
class Kelt9Fossati : public Spectrum {
 public:
  Kelt9Fossati();

  double operator()(double wavelength) override;

  double max_wavelength() override;

  double min_wavelength() override;

 private:
  static std::vector<double> wavelengths_; // nm

  static std::vector<double> spectral_flux_densities_; // ?

  std::shared_ptr<boost::math::interpolators::barycentric_rational<double>>
  interpolator_;

  double max_wavelength_ = 0.0;

  double min_wavelength_ = 0.0;
};


inline Kelt9Fossati::Kelt9Fossati() {
  max_wavelength_ = *std::max_element(wavelengths_.begin(), wavelengths_.end());
  min_wavelength_ = *std::min_element(wavelengths_.begin(), wavelengths_.end());
  interpolator_ =
    std::make_shared<boost::math::interpolators::barycentric_rational<double>>(
      std::move(wavelengths_), std::move(spectral_flux_densities_)
    )
  ;
}


inline double Kelt9Fossati::operator()(double wavelength) {
  return interpolator_->operator()(wavelength);
}


inline double Kelt9Fossati::max_wavelength() {
  return max_wavelength_;
}


inline double Kelt9Fossati::min_wavelength() {
  return min_wavelength_;
}


inline std::vector<double> Kelt9Fossati::wavelengths_{
  39.27, 39.52, 39.77, 40.02, 40.27, 40.52, 40.77, 41.02, 41.27, 41.52, 41.77, 42.02, 42.27, 42.52, 42.77, 43.02, 43.27, 43.52, 43.77, 44.02, 44.27, 44.52, 44.77, 45.02, 45.27, 45.52, 45.77, 46.02, 46.27, 46.507066, 46.7, 46.948922, 47.13, 47.38, 47.63, 47.88, 48.13, 48.38, 48.63, 48.88, 49.13, 49.38, 49.63, 49.88, 50.13, 50.38, 50.61000000000001, 50.86000000000001, 51.11000000000001, 51.36000000000001, 51.61000000000001, 51.86000000000001, 52.11000000000001, 52.29, 52.54, 52.79, 53.04, 53.27000000000001, 53.52000000000001, 53.706366, 53.95, 54.2, 54.45, 54.7, 54.95, 55.2, 55.45, 55.7, 55.95, 56.2, 56.45, 56.7, 56.95, 57.2, 57.45, 57.67000000000001, 57.89, 58.14, 58.39, 58.57000000000001, 58.82000000000001, 59.07000000000001, 59.32000000000001, 59.57000000000001, 59.82000000000001, 60.07000000000001, 60.25, 60.5, 60.75, 61.0, 61.21000000000001, 61.39, 61.57000000000001, 61.82000000000001, 61.93, 62.18, 62.43, 62.67974000000001, 62.79, 62.97264800000001, 63.160000000000004, 63.410000000000004, 63.660000000000004, 63.910000000000004, 64.052595, 64.176771, 64.38, 64.63, 64.88, 65.13, 65.273321, 65.42, 65.67, 65.9, 66.15, 66.33, 66.51, 66.67, 66.909906, 66.96000000000001, 67.14, 67.39, 67.64, 67.89, 68.07000000000001, 68.24, 68.41000000000001, 68.66000000000001, 68.892875, 69.0, 69.13759, 69.22000000000001, 69.4, 69.51, 69.76, 69.95, 70.19, 70.44, 70.62, 70.786199, 70.91000000000001, 71.16000000000001, 71.34, 71.52000000000001, 71.63, 71.74, 71.863911, 72.023552, 72.14, 72.23773, 72.320024, 72.42, 72.547038, 72.641458, 72.709552, 72.768589, 72.86369, 72.97706500000001, 73.16000000000001, 73.241765, 73.41000000000001, 73.520022, 73.595978, 73.7, 73.734024, 73.795015, 73.832309, 74.01, 74.066395, 74.094723, 74.14, 74.25, 74.37195200000001, 74.457367, 74.483706, 74.494557, 74.557381, 74.565353, 74.640393, 74.69654799999999, 74.91000000000001, 75.08, 75.198193, 75.263349, 75.333664, 75.413405, 75.62, 75.8, 75.96000000000001, 76.06, 76.14, 76.25, 76.26849800000001, 76.310957, 76.382296, 76.489286, 76.581376, 76.72657400000001, 76.789316, 76.81344100000001, 76.93, 77.09, 77.144636, 77.178707, 77.31, 77.49000000000001, 77.600767, 77.62600800000001, 77.67936200000001, 77.70732400000001, 77.734373, 77.77000000000001, 77.89, 78.12, 78.25703200000001, 78.306667, 78.41000000000001, 78.46428900000001, 78.524947, 78.54516100000001, 78.56393100000001, 78.615378, 78.7, 78.81, 78.9, 79.08, 79.24304000000001, 79.4, 79.44865700000001, 79.60000000000001, 79.85000000000001, 80.10000000000001, 80.27376100000001, 80.336684, 80.46560600000001, 80.52000000000001, 80.668186, 80.77000000000001, 80.95, 81.04, 81.182478, 81.26641000000001, 81.37, 81.42578700000001, 81.56, 81.61549400000001, 81.77000000000001, 81.81, 81.91000000000001, 82.01, 82.05146400000001, 82.101577, 82.19, 82.35000000000001, 82.452249, 82.513709, 82.54232300000001, 82.614126, 82.74000000000001, 82.92000000000002, 83.13008, 83.160336, 83.19300100000001, 83.36000000000001, 83.45, 83.57369800000001, 83.623016, 83.68296400000001, 83.85000000000001, 83.985555, 84.050818, 84.09, 84.12298100000001, 84.16865100000001, 84.21000000000001, 84.256843, 84.37399900000001, 84.41000000000001, 84.57000000000001, 84.621485, 84.79, 84.838739, 84.93578400000001, 85.05000000000001, 85.19978, 85.305743, 85.508015, 85.54065200000001, 85.74587000000001, 85.9, 86.08, 86.15904900000001, 86.256342, 86.39559400000002, 86.43461300000001, 86.58, 86.83, 86.97000000000001, 87.15, 87.31, 87.45, 87.54392000000001, 87.59459100000001, 87.661564, 87.74000000000001, 87.92000000000002, 88.10000000000001, 88.220125, 88.35000000000001, 88.48396000000001, 88.56714500000001, 88.632501, 88.682148, 88.77970900000001, 88.83795400000001, 88.92000000000002, 88.99686400000002, 89.025846, 89.127864, 89.23, 89.385628, 89.42311600000001, 89.52705800000001, 89.55207100000001, 89.65, 89.81, 89.881217, 89.93, 89.99074900000001, 90.05000000000001, 90.14207400000001, 90.19814600000001, 90.24000000000001, 90.325879, 90.42054900000001, 90.5, 90.52890400000001, 90.555946, 90.58980700000001, 90.62351100000001, 90.66029200000001, 90.69025500000001, 90.725986, 90.75651, 90.76514300000001, 90.852627, 90.92000000000002, 90.98956500000001, 91.029391, 91.064536, 91.117241, 91.17000000000002, 91.218484, 91.27238, 91.29483400000001,
};


inline std::vector<double> Kelt9Fossati::spectral_flux_densities_{
  9.99001e-13, 1.33932e-12, 1.78863e-12, 2.37959e-12, 3.15402e-12, 4.17078e-12, 5.48087e-12, 7.18667e-12, 9.39079e-12, 1.22293e-11, 1.58726e-11, 2.05339e-11, 2.65058e-11, 3.40369e-11, 4.36171e-11, 5.58515e-11, 7.09768e-11, 9.01399e-11, 1.14271e-10, 1.44137e-10, 1.81499e-10, 2.27919e-10, 2.85441e-10, 3.56532e-10, 4.4417e-10, 5.52613e-10, 6.84116e-10, 8.45857e-10, 1.0433e-09, 1.27011e-09, 1.48842e-09, 1.82229e-09, 2.10846e-09, 2.57381e-09, 3.13487e-09, 3.80985e-09, 4.62018e-09, 5.59097e-09, 6.75287e-09, 8.2142e-09, 9.87709e-09, 1.1852e-08, 1.41945e-08, 1.69673e-08, 2.02433e-08, 2.41067e-08, 3.64263e-08, 4.33451e-08, 5.10562e-08, 6.02847e-08, 7.10573e-08, 8.36103e-08, 9.81314e-08, 1.10007e-07, 1.29053e-07, 1.51076e-07, 1.77105e-07, 1.8261e-07, 2.10619e-07, 2.7705e-07, 2.86407e-07, 3.12967e-07, 3.6229e-07, 4.18086e-07, 6.48857e-07, 5.56005e-07, 6.39847e-07, 7.35374e-07, 8.44085e-07, 9.67515e-07, 1.10753e-06, 1.26626e-06, 1.44581e-06, 1.69083e-06, 1.8773e-06, 2.11863e-06, 2.3303e-06, 2.62782e-06, 2.85863e-06, 3.20489e-06, 3.70071e-06, 4.19882e-06, 4.74963e-06, 5.35665e-06, 6.03449e-06, 6.79155e-06, 7.39004e-06, 8.3014e-06, 9.31559e-06, 1.04426e-05, 1.14703e-05, 1.24377e-05, 1.34275e-05, 1.50611e-05, 1.58172e-05, 1.7639e-05, 1.96616e-05, 2.17804e-05, 2.2953e-05, 2.27154e-05, 2.68285e-05, 2.9795e-05, 3.30636e-05, 3.66533e-05, 4.56428e-05, 4.25053e-05, 4.43993e-05, 4.90987e-05, 5.42445e-05, 6.45329e-05, 8.51758e-05, 6.71026e-05, 7.39902e-05, 8.0808e-05, 8.8921e-05, 9.52139e-05, 0.000101912, 0.000108215, 0.000118626, 0.000120584, 0.000194309, 0.000141274, 0.000154747, 0.00016941, 0.000195711, 0.000192113, 0.000203902, 0.000222971, 0.000242015, 0.000250777, 0.000269326, 0.000270613, 0.00028788, 0.000305176, 0.000325501, 0.000348378, 0.000376247, 0.000408947, 0.000434066, 0.000515237, 0.00047754, 0.000518037, 0.000549217, 0.000581936, 0.000602794, 0.000631415, 0.00065324, 0.00068321, 0.000709302, 0.000736625, 0.000751562, 0.000774938, 0.00080546, 0.000829546, 0.000846811, 0.0012, 0.000894908, 0.000921369, 0.000976036, 0.00151, 0.00105, 0.00109, 0.00111, 0.00115, 0.00117, 0.00118, 0.00119, 0.0013, 0.00128, 0.00129, 0.00131, 0.00135, 0.00133, 0.00143, 0.00144, 0.00161, 0.00148, 0.00149, 0.00151, 0.00159, 0.00164, 0.00172, 0.00178, 0.00181, 0.00186, 0.00189, 0.00201, 0.00211, 0.00223, 0.00228, 0.00232, 0.00239, 0.00241, 0.00245, 0.00248, 0.00256, 0.00262, 0.00273, 0.00281, 0.0028, 0.00289, 0.00301, 0.00309, 0.00311, 0.0032, 0.00336, 0.0035, 0.00352, 0.00353, 0.00356, 0.00359, 0.00362, 0.00374, 0.00397, 0.00416, 0.00417, 0.00429, 0.00435, 0.00442, 0.00446, 0.00446, 0.00457, 0.00462, 0.00476, 0.00487, 0.0051, 0.00532, 0.00572, 0.00564, 0.00583, 0.00621, 0.00661, 0.0069, 0.00701, 0.00728, 0.00733, 0.0077, 0.0078, 0.00815, 0.00833, 0.00869, 0.0088, 0.00903, 0.0092, 0.0095, 0.01435, 0.00994, 0.01003, 0.01029, 0.01052, 0.01065, 0.01077, 0.01098, 0.0114, 0.01168, 0.01186, 0.01195, 0.01367, 0.01249, 0.01302, 0.01369, 0.0138, 0.01391, 0.01476, 0.02248, 0.01534, 0.01535, 0.01551, 0.0196, 0.0166, 0.01691, 0.017, 0.01729, 0.01768, 0.01747, 0.01764, 0.01811, 0.01828, 0.02016, 0.01913, 0.01997, 0.02007, 0.0205, 0.02102, 0.02354, 0.02223, 0.02322, 0.02339, 0.02446, 0.02527, 0.02625, 0.02676, 0.02725, 0.02815, 0.0283, 0.02919, 0.03074, 0.03364, 0.03286, 0.03396, 0.03495, 0.03578, 0.04667, 0.0365, 0.03709, 0.03847, 0.0399, 0.04088, 0.04196, 0.0431, 0.04385, 0.04441, 0.04484, 0.04572, 0.04629, 0.04701, 0.04773, 0.048, 0.04898, 0.04997, 0.05152, 0.05189, 0.05296, 0.05321, 0.05424, 0.05595, 0.0568, 0.05789, 0.05811, 0.05875, 0.0597, 0.0603, 0.06079, 0.06192, 0.07177, 0.06396, 0.06427, 0.06458, 0.06498, 0.06539, 0.06595, 0.06611, 0.06682, 0.06725, 0.06743, 0.06827, 0.06915, 0.07005, 0.07057, 0.07105, 0.07182, 0.07245, 0.07314, 0.072, 0.07532,
};


}